/**
 * universe-bg
 * @version v0.2.2 - 2015-07-28
 * @link http://html5beta.com/apps/universe.html
 * @author ZHAO Xudong (zxdong@gmail.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t,n){function o(e){this.init(e),this.animate(),this.event()}o.defaults={size:5,starNumber:1e4,color:16777215},o.prototype.init=function(n){var a=n||{},i=this;i.options={size:a.size||o.defaults.size,id:a.id,starNumber:a.starNumber||o.defaults.starNumber,color:a.color||o.defaults.color,map:a.map},i.container=a.container||t.body,a=i.options,i.state={mouseX:0,mouseY:0,width:a.width||i.container.clientWidth,height:a.height||i.container.clientHeight,windowHalfX:i.container.clientWidth/2,windowHalfY:i.container.clientHeight/2},i.scene=new THREE.Scene,i.camera=new THREE.PerspectiveCamera(50,i.state.width/i.state.height,150,4e3);for(var r=new THREE.Geometry,s=0;s<a.starNumber;s++){var c=new THREE.Vector3;c.x=THREE.Math.randFloatSpread(4e3),c.y=THREE.Math.randFloatSpread(4e3),c.z=THREE.Math.randFloatSpread(4e3),r.vertices.push(c)}var d=new THREE.PointCloud(r,new THREE.PointCloudMaterial({color:a.color,size:a.size,map:i.options.map||null,transparent:!0}));i.scene.add(d),i.renderer=new THREE.WebGLRenderer({antialias:!0}),i.renderer.setPixelRatio(e.devicePixelRatio),i.renderer.setSize(i.state.width,i.state.height),i.renderer.domElement.id=a.id||"id"+(new Date).getTime(),i.container.appendChild(i.renderer.domElement),i.renderer.autoClear=!1},o.prototype.render=function(){var e=5e-4*Date.now(),t=this,n=t.state.height/500*.02,o=t.state.width/1e3*.02;t.camera.fov=35+90*Math.sin(.5*e),t.camera.updateProjectionMatrix(),t.camera.position.x+=(t.state.mouseX-t.camera.position.x)*n,t.camera.position.y+=(-t.state.mouseY-t.camera.position.y)*o,t.camera.lookAt(t.scene.position),t.renderer.clear(),t.renderer.setViewport(0,0,t.state.width,t.state.height),t.renderer.render(t.scene,t.camera)},o.prototype.animate=function(){function e(){requestAnimationFrame(e),t.render()}var t=this;e()},o.prototype.event=function(){var n=this;t.addEventListener("mousemove",n.onDocumentMouseMove(),!1),t.addEventListener("touchstart",n.onDocumentTouchStart(),!1),t.addEventListener("touchmove",n.onDocumentTouchMove(),!1),e.addEventListener("resize",n.onWindowResize(),!1)},o.prototype.onDocumentMouseMove=function(){var e=this;return function(t){e.state.mouseX=t.clientX-e.state.windowHalfX,e.state.mouseY=t.clientY-e.state.windowHalfY}},o.prototype.onDocumentTouchStart=function(){var e=this;return function(t){1===t.touches.length&&(t.preventDefault(),e.state.mouseX=t.touches[0].pageX-e.state.windowHalfX,e.state.mouseY=t.touches[0].pageY-e.state.windowHalfY)}},o.prototype.onDocumentTouchMove=function(){var e=this;return function(t){1===t.touches.length&&(t.preventDefault(),e.state.mouseX=t.touches[0].pageX-e.state.windowHalfX,e.state.mouseY=t.touches[0].pageY-e.state.windowHalfY)}},o.prototype.onWindowResize=function(){var e=this;return function(){e.state.width=e.container.clientWidth,e.state.height=e.container.clientHeight,e.state.windowHalfX=e.container.clientWidth/2,e.state.windowHalfY=e.container.clientHeight/2,e.renderer.setSize(e.state.width,e.state.height),e.camera.aspect=e.state.width/e.state.height,e.camera.updateProjectionMatrix()}},e.Universe=o}(window,document);