/**
 * universe-bg
 * @version v0.2.1 - 2015-07-24
 * @link http://html5beta.com/apps/universe.html
 * @author ZHAO Xudong (zxdong@gmail.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t,n){function a(e){this.init(e),this.animate(),this.event()}a.defaults={size:5,starNumber:1e4,color:16777215},a.prototype.init=function(n){var o=n||{},i=this;i.options={size:o.size||a.defaults.size,id:o.id,starNumber:o.starNumber||a.defaults.starNumber,color:o.color||a.defaults.color,map:o.map},i.container=o.container||t.body,o=i.options,i.state={mouseX:0,mouseY:0,width:o.width||i.container.clientWidth,height:o.height||i.container.clientHeight,windowHalfX:i.container.clientWidth/2,windowHalfY:i.container.clientHeight/2},i.scene=new THREE.Scene,i.camera=new THREE.PerspectiveCamera(50,i.state.width/i.state.height,150,4e3);for(var r=new THREE.Geometry,s=0;s<o.starNumber;s++){var c=new THREE.Vector3;c.x=THREE.Math.randFloatSpread(4e3),c.y=THREE.Math.randFloatSpread(4e3),c.z=THREE.Math.randFloatSpread(4e3),r.vertices.push(c)}var d=(THREE.ImageUtils.loadTexture("star.png"),new THREE.PointCloud(r,new THREE.PointCloudMaterial({color:o.color,size:o.size,map:i.options.map||null,transparent:!0})));i.scene.add(d),i.renderer=new THREE.WebGLRenderer({antialias:!0}),i.renderer.setPixelRatio(e.devicePixelRatio),i.renderer.setSize(i.state.width,i.state.height),i.renderer.domElement.id=o.id||"id"+(new Date).getTime(),i.container.appendChild(i.renderer.domElement),i.renderer.autoClear=!1},a.prototype.render=function(){var e=5e-4*Date.now(),t=this,n=t.state.height/500*.02,a=t.state.width/1e3*.02;t.camera.fov=35+90*Math.sin(.5*e),t.camera.updateProjectionMatrix(),t.camera.position.x+=(t.state.mouseX-t.camera.position.x)*n,t.camera.position.y+=(-t.state.mouseY-t.camera.position.y)*a,t.camera.lookAt(t.scene.position),t.renderer.clear(),t.renderer.setViewport(0,0,t.state.width,t.state.height),t.renderer.render(t.scene,t.camera)},a.prototype.animate=function(){function e(){requestAnimationFrame(e),t.render()}var t=this;e()},a.prototype.event=function(){var n=this;t.addEventListener("mousemove",n.onDocumentMouseMove(),!1),t.addEventListener("touchstart",n.onDocumentTouchStart(),!1),t.addEventListener("touchmove",n.onDocumentTouchMove(),!1),e.addEventListener("resize",n.onWindowResize(),!1)},a.prototype.onDocumentMouseMove=function(){var e=this;return function(t){e.state.mouseX=t.clientX-e.state.windowHalfX,e.state.mouseY=t.clientY-e.state.windowHalfY}},a.prototype.onDocumentTouchStart=function(){var e=this;return function(t){1===t.touches.length&&(t.preventDefault(),e.state.mouseX=t.touches[0].pageX-e.state.windowHalfX,e.state.mouseY=t.touches[0].pageY-e.state.windowHalfY)}},a.prototype.onDocumentTouchMove=function(){var e=this;return function(t){1===t.touches.length&&(t.preventDefault(),e.state.mouseX=t.touches[0].pageX-e.state.windowHalfX,e.state.mouseY=t.touches[0].pageY-e.state.windowHalfY)}},a.prototype.onWindowResize=function(){var e=this;return function(){e.state.width=e.container.clientWidth,e.state.height=e.container.clientHeight,e.state.windowHalfX=e.container.clientWidth/2,e.state.windowHalfY=e.container.clientHeight/2,e.renderer.setSize(e.state.width,e.state.height),e.camera.aspect=e.state.width/e.state.height,e.camera.updateProjectionMatrix()}},e.Universe=a}(window,document);